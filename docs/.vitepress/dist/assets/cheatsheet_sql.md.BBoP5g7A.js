import{_ as i,c as a,o as t,ag as n}from"./chunks/framework.GdcW6lnn.js";const c=JSON.parse('{"title":"Шпаргалка по SQL","description":"Шпаргалка по SQL","frontmatter":{"sidebar_position":27,"title":"Шпаргалка по SQL","description":"Шпаргалка по SQL","keywords":["sql","structured query language","cheatsheet","шпаргалка","язык структурированных запросов"],"tags":["sql","structured query language","cheatsheet","шпаргалка","язык структурированных запросов"]},"headers":[],"relativePath":"cheatsheet/sql.md","filePath":"cheatsheet/sql.md"}'),l={name:"cheatsheet/sql.md"};function e(h,s,p,d,k,E){return t(),a("div",null,s[0]||(s[0]=[n(`<h1 id="sql" tabindex="-1">SQL <a class="header-anchor" href="#sql" aria-label="Permalink to “SQL”">​</a></h1><p><em>Обратите внимание</em>: изучение данной шпаргалки не сделает вас мастером <code>SQL</code>, но позволит получить общее представление об этом языке и возможностях, которые он предоставляет. Рассматриваемые в шпаргалке возможности являются общими для всех или большинства диалектов <code>SQL</code>.</p><p>Для более полного погружения в <code>SQL</code> рекомендую изучить эти руководства по <a href="https://metanit.com/sql/mysql/"><code>MySQL</code></a> и <a href="https://metanit.com/sql/postgresql/"><code>PostgreSQL</code></a> от Метанита. Они хороши тем, что просты в изучении и позволяют быстро начать работу с названными СУБД.</p><ul><li><a href="https://dev.mysql.com/doc/refman/8.0/en/">Официальная документация по MySQL</a>.</li><li><a href="https://postgrespro.ru/docs/postgresql/13/index">Официальная документация по PostgreSQL</a> (на русском языке).</li><li><a href="https://www.youtube.com/watch?app=desktop&amp;v=HXV3zeQKqGY">Свежий туториал по SQL от Codecamp</a>.</li><li><a href="https://websitesetup.org/wp-content/uploads/2020/08/SQL-Cheat-Sheet-Summary-Full.png">Свежая шпаргалка по SQL в формате PDF</a>.</li></ul><h2 id="что-такое-sql" tabindex="-1">Что такое SQL? <a class="header-anchor" href="#что-такое-sql" aria-label="Permalink to “Что такое SQL?”">​</a></h2><p>SQL - это язык структурированных запросов (Structured Query Language), позволяющий хранить, манипулировать и извлекать данные из реляционных баз данных (далее - РБД, БД).</p><h2 id="почему-sql" tabindex="-1">Почему SQL? <a class="header-anchor" href="#почему-sql" aria-label="Permalink to “Почему SQL?”">​</a></h2><p>SQL позволяет:</p><ul><li>получать доступ к данным в системах управления РБД</li><li>описывать данные (их структуру)</li><li>определять данные в БД и управлять ими</li><li>взаимодействовать с другими языками через модули SQL, библиотеки и предваритальные компиляторы</li><li>создавать и удалять БД и таблицы</li><li>создавать представления, хранимые процедуры (stored procedures) и функции в БД</li><li>устанавливать разрешения на доступ к таблицам, процедурам и представлениям</li></ul><h2 id="процесс-sql" tabindex="-1">Процесс SQL <a class="header-anchor" href="#процесс-sql" aria-label="Permalink to “Процесс SQL”">​</a></h2><p>При выполнении любой SQL-команды в любой RDBMS (Relational Database Management System - система управления РБД, СУБД, например, PostgreSQL, MySQL, MSSQL, SQLite и др.) система определяет наилучший способ выполнения запроса, а движок SQL определяет способ интерпретации задачи.</p><p>В данном процессе участвует несколького компонентов:</p><ul><li>диспетчер запросов (Query Dispatcher)</li><li>движок оптимизации (Optimization Engines)</li><li>классический движок запросов (Classic Query Engine)</li><li>движок запросов SQL (SQL Query Engine) и т.д.</li></ul><p>Классический движок обрабатывает все не-SQL-запросы, а движок SQL-запросов не обрабатывает логические файлы.</p><h2 id="команды-sql" tabindex="-1">Команды SQL <a class="header-anchor" href="#команды-sql" aria-label="Permalink to “Команды SQL”">​</a></h2><p>Стандартными командами для взаимодействия с РБД являются <code>CREATE</code>, <code>SELECT</code>, <code>INSERT</code>, <code>UPDATE</code>, <code>DELETE</code> и <code>DROP</code>. Эти команды могут быть классифицированы следующим образом:</p><ul><li><code>DDL</code> - язык определения данных (Data Definition Language)</li></ul><table tabindex="0"><thead><tr><th>N</th><th>Команда</th><th>Описание</th></tr></thead><tbody><tr><td>1</td><td>CREATE</td><td>Создает новую таблицу, представление таблицы или другой объект в БД</td></tr><tr><td>2</td><td>ALTER</td><td>Модифицирует существующий в БД объект, такой как таблица</td></tr><tr><td>3</td><td>DROP</td><td>Удаляет существующую таблицу, представление таблицы или другой объект в БД</td></tr></tbody></table><ul><li><code>DML</code> - язык изменения данных (Data Manipulation Language)</li></ul><table tabindex="0"><thead><tr><th>N</th><th>Команда</th><th>Описание</th></tr></thead><tbody><tr><td>1</td><td>SELECT</td><td>Извлекает записи из одной или нескольких таблиц</td></tr><tr><td>2</td><td>INSERT</td><td>Создает записи</td></tr><tr><td>3</td><td>UPDATE</td><td>Модифицирует записи</td></tr><tr><td>4</td><td>DELETE</td><td>Удаляет записи</td></tr></tbody></table><ul><li><code>DCL</code> - язык управления данными (Data Control Language)</li></ul><table tabindex="0"><thead><tr><th>N</th><th>Команда</th><th>Описание</th></tr></thead><tbody><tr><td>1</td><td>GRANT</td><td>Наделяет пользователя правами</td></tr><tr><td>1</td><td>REVOKE</td><td>Отменяет права пользователя</td></tr></tbody></table><p><em>Обратите внимание</em>: использование верхнего регистра в названиях команд SQL - это всего лишь соглашение, большинство СУБД нечувствительны к регистру. Тем не менее, форма записи инструкций, когда названия команд пишутся большими буквами, а названия таблиц, колонок и др. - маленькими, позволяет быстро определять назначение производимой с данными операции.</p><h2 id="что-такое-таблица" tabindex="-1">Что такое таблица? <a class="header-anchor" href="#что-такое-таблица" aria-label="Permalink to “Что такое таблица?”">​</a></h2><p>Данные в СУБД хранятся в объектах БД, называемых таблицами (tables). Таблица, как правило, представляет собой коллекцию связанных между собой данных и состоит из определенного количества колонок и строк.</p><p>Таблица - это самая распространенная и простая форма хранения данных в РБД. Вот пример таблицы с пользователями (users):</p><table tabindex="0"><thead><tr><th>userId</th><th>userName</th><th>age</th><th>city</th><th>status</th></tr></thead><tbody><tr><td>1</td><td>Igor</td><td>25</td><td>Moscow</td><td>active</td></tr><tr><td>2</td><td>Vika</td><td>26</td><td>Ekaterinburg</td><td>inactive</td></tr><tr><td>3</td><td>Elena</td><td>27</td><td>Ekaterinburg</td><td>active</td></tr><tr><td>4</td><td>Oleg</td><td>28</td><td>Moscow</td><td>inactive</td></tr></tbody></table><h2 id="что-такое-поле" tabindex="-1">Что такое поле? <a class="header-anchor" href="#что-такое-поле" aria-label="Permalink to “Что такое поле?”">​</a></h2><p>Каждая таблица состоит из небольших частей - полей (fields). Полями в таблице users являются userId, userName, age, city и status. Поле - это колонка таблицы, предназначенная для хранения определенной информации о каждой записи в таблице.</p><p><em>Обратите внимание</em>: вместо <code>userId</code> и <code>userName</code> можно было бы использовать <code>id</code> и <code>name</code>, соответственно. Но при работе с несколькими объектами, содержащими свойство <code>id</code>, бывает сложно понять, какому объекту принадлежит идентификатор, особенно, если вы, как и я, часто прибегаете к деструктуризации. Что касается слова <code>name</code>, то оно часто оказывается зарезервизованным, т.е. уже используется в среде, в которой выполняется код, поэтому я стараюсь его не использовать.</p><h2 id="что-такое-запись-или-строка" tabindex="-1">Что такое запись или строка? <a class="header-anchor" href="#что-такое-запись-или-строка" aria-label="Permalink to “Что такое запись или строка?”">​</a></h2><p>Запись или строка (record/row) - это любое единичное вхождение (entry), существующее в таблице. В таблице <code>users</code> 5 записей. Проще говоря, запись - это горизонтальное вхождение в таблице.</p><h2 id="что-такое-колонка" tabindex="-1">Что такое колонка? <a class="header-anchor" href="#что-такое-колонка" aria-label="Permalink to “Что такое колонка?”">​</a></h2><p>Колонка (column) - это вертикальное вхождение в таблице, содержащее всю информацию, связанную с определенным полем. В таблице <code>users</code> одной из колонок является <code>city</code>, которая содержит названия городов, в которых проживают пользователи.</p><h2 id="что-такое-null" tabindex="-1">Что такое <code>NULL</code>? <a class="header-anchor" href="#что-такое-null" aria-label="Permalink to “Что такое NULL?”">​</a></h2><p><code>NULL</code> - это значение поля, которое является пустым, т.е. это значение поля, не имеющего значения. Важно понимать, что значение <code>NULL</code> отличается от значения <code>0</code> и от значения поля, содержащего пробелы (<code></code>). Поле со значением <code>NULL</code> - это такое поле, которое осталось пустым при создании записи. Также, следует учитывать, что в некоторых СУБД пустая строка (<code>&#39;&#39;</code>) — это <code>NULL</code>, а в некоторых - это разные значения.</p><h2 id="ограничения" tabindex="-1">Ограничения <a class="header-anchor" href="#ограничения" aria-label="Permalink to “Ограничения”">​</a></h2><p>Ограничения (constraints) - это правила, применяемые к данным. Они используются для ограничения данных, которые могут быть записаны в таблицу. Это обеспечивает точность и достоверность данных в БД.</p><p>Ограничения могут устанавливаться как на уровне колонки, так и на уровне таблицы.</p><p>Среди наиболее распространенных ограничений можно назвать следующие:</p><ul><li><code>NOT NULL</code> - колонка не может иметь значение <code>NULL</code></li><li><code>DEFAULT</code> - значение колонки по умолчанию</li><li><code>UNIQUE</code> - все значения колонки должны быть уникальными</li><li><code>PRIMARY KEY</code> - первичный или основной ключ, уникальный идентификатор записи в текущей таблице</li><li><code>FOREIGN KEY</code> - внешний ключ, уникальный идентификатор записи в другой таблице (таблице, связанной с текущей)</li><li><code>CHECK</code> - все значения в колонке должны удовлетворять определенному условию</li><li><code>INDEX</code> - быстрая запись и извлечение данных</li></ul><p>Любое ограничение может быть удалено с помощью команды <code>ALTER TABLE</code> и <code>DROP CONSTRAINT</code> + название ограничения. Некоторые реализации предоставляют сокращения для удаления ограничений и возможность отключать ограничения вместо их удаления.</p><h2 id="целостность-данных" tabindex="-1">Целостность данных <a class="header-anchor" href="#целостность-данных" aria-label="Permalink to “Целостность данных”">​</a></h2><p>В каждой СУБД существуют следующие категории целостности данных:</p><ul><li>целостность объекта (Entity Integrity) - в таблице не должно быть дубликатов (двух и более строк с одинаковыми значениями)</li><li>целостность домена (Domain Integrity) - фильтрация значений по типу, формату или диапазону</li><li>целостность ссылок (Referential integrity) - строки, используемые другими записями (строки, на которые в других записях имеются ссылки), не могут быть удалены</li><li>целостность, определенная пользователем (User-Defined Integrity) - дополнительные правила</li></ul><h2 id="нормализация-бд" tabindex="-1">Нормализация БД <a class="header-anchor" href="#нормализация-бд" aria-label="Permalink to “Нормализация БД”">​</a></h2><p>Нормализация - это процесс эффективной организации данных в БД. Существует две главных причины, обуславливающих необходимость нормализации:</p><ul><li>предотвращение записи в БД лишних данных, например, хранения одинаковых данных в разных таблицах</li><li>обеспечение &quot;оправданной&quot; связи между данными</li></ul><p>Нормализация предполагает соблюдение нескольких форм. Форма - это формат структурирования БД. Существует три главных формы: первая, вторая и, соответственно, третья. Я не буду вдаваться в подробности об этих формах, при желании, вы без труда найдете необходимую информацию.</p><h2 id="синтаксис-sql" tabindex="-1">Синтаксис SQL <a class="header-anchor" href="#синтаксис-sql" aria-label="Permalink to “Синтаксис SQL”">​</a></h2><p>Синтаксис - это уникальный набор правил и рекомендаций. Все инструкции <code>SQL</code> должны начинаться с ключевого слова, такого как <code>SELECT</code>, <code>INSERT</code>, <code>UPDATE</code>, <code>DELETE</code>, <code>ALTER</code>, <code>DROP</code>, <code>CREATE</code>, <code>USE</code>, <code>SHOW</code> и т.п. и заканчиваться точкой с запятой (<code>;</code>) (точка с запятой не входит в синтаксис <code>SQL</code>, но ее наличия, как правило, требуют консольные клиенты СУБД для обозначения окончания ввода команды). <code>SQL</code> не чувствителен к регистру, т.е. <code>SELECT</code>, <code>select</code> и <code>SeLeCt</code> являются идентичными инструкциями. Исключением из этого правила является <code>MySQL</code>, где учитывается регистр в названии таблицы.</p><p><strong>Примеры синтаксиса</strong></p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- выборка</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT DISTINCT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> condition;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> condition1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">|</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> condition2;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col2, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> colName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">IN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (val1, val2, ...valN);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> colName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BETWEEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> val1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> val2;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> colName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LIKE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pattern;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> condition</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> colName [ASC|DESC];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(colName)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> condition</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GROUP BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> colName;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(colName)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> condition;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(colName)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> condition</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GROUP BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> colName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">HAVING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> condition);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- создание таблицы</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> tableName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  col1 datatype,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  col2 datatype,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  colN datatype,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (одна или более колонка)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- удаление таблицы</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- создание индекса</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNIQUE INDEX</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> indexName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName (col1, col2, ...colN);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- удаление индекса</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> INDEX</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> indexName;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- получение описания структуры таблицы</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- очистка таблицы</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TRUNCATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- добавление/удаление/модификация колонок</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ADD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">|</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">|</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">MODIFY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> colName [datatype];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- переименование таблицы</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName RENAME </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newTableName;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- вставка значений</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName (col1, col2, ...colN)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (val1, val2, ...valN)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- обновление записей</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> val1, col2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> val2, ...colN </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> valN</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[WHERE condition];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- удаление записей</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DELETE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> condition;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- создание БД</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DATABASE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [IF NOT EXISTS] dbName;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- удаление БД</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DATABASE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [IF EXISTS] dbName;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- выбор БД</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">USE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dbName;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- завершения транзакции</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COMMIT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- отмена изменений</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROLLBACK</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><h2 id="типы-данных" tabindex="-1">Типы данных <a class="header-anchor" href="#типы-данных" aria-label="Permalink to “Типы данных”">​</a></h2><p>Каждая колонка, переменная и выражение в <code>SQL</code> имеют определенный тип данных (data type). Основные категории типов данных:</p><p><strong>Точные числовые</strong></p><table tabindex="0"><thead><tr><th>Тип данных</th><th>От</th><th>До</th></tr></thead><tbody><tr><td>bigint</td><td>-9,223,372,036,854,775,808</td><td>9,223,372,036,854,775,807</td></tr><tr><td>int</td><td>-2,147,483,648</td><td>2,147,483,647</td></tr><tr><td>smallint</td><td>-32,768</td><td>32,767</td></tr><tr><td>tinyint</td><td>0</td><td>255</td></tr><tr><td>bit</td><td>0</td><td>1</td></tr><tr><td>decimal</td><td>-10^38 +1</td><td>10^38 -1</td></tr><tr><td>numeric</td><td>-10^38 +1</td><td>10^38 -1</td></tr><tr><td>money</td><td>-922,337,203,685,477.5808</td><td>+922,337,203,685,477.5807</td></tr><tr><td>smallmoney</td><td>-214,748.3648</td><td>+214,748.3647</td></tr></tbody></table><p><strong>Приблизительные числовые</strong></p><table tabindex="0"><thead><tr><th>Тип данных</th><th>От</th><th>До</th></tr></thead><tbody><tr><td>float</td><td>-1.79E + 308</td><td>1.79E + 308</td></tr><tr><td>real</td><td>-3.40E + 38</td><td>3.40E + 38</td></tr></tbody></table><p><strong>Дата и время</strong></p><table tabindex="0"><thead><tr><th>Тип данных</th><th>От</th><th>До</th></tr></thead><tbody><tr><td>datetime</td><td>Jan 1, 1753</td><td>Dec 31, 9999</td></tr><tr><td>smalldatetime</td><td>Jan 1, 1900</td><td>Jun 6, 2079</td></tr><tr><td>date</td><td>Дата сохраняется в виде June 30, 1991</td><td></td></tr><tr><td>time</td><td>Время сохраняется в виде 12:30 P.M.</td><td></td></tr></tbody></table><p><strong>Строковые символьные</strong></p><table tabindex="0"><thead><tr><th>N</th><th>Тип данных</th><th>Описание</th></tr></thead><tbody><tr><td>1</td><td>char</td><td>Строка длиной до 8,000 символов (не-юникод символы, фиксированной длины)</td></tr><tr><td>2</td><td>varchar</td><td>Строка длиной до 8,000 символов (не-юникод символы, переменной длины)</td></tr><tr><td>3</td><td>text</td><td>Не-юникод данные переменной длины, длиной до 2,147,483,647 символов</td></tr></tbody></table><p><strong>Строковые символьные (юникод)</strong></p><table tabindex="0"><thead><tr><th>N</th><th>Тип данных</th><th>Описание</th></tr></thead><tbody><tr><td>1</td><td>nchar</td><td>Строка длиной до 4,000 символов (юникод символы, фиксированной длины)</td></tr><tr><td>2</td><td>nvarchar</td><td>Строка длиной до 4,000 символов (юникод символы, переменной длины)</td></tr><tr><td>3</td><td>ntext</td><td>Юникод данные переменной длины, длиной до 1,073,741,823 символов</td></tr></tbody></table><p><strong>Бинарные</strong></p><table tabindex="0"><thead><tr><th>N</th><th>Тип данных</th><th>Описание</th></tr></thead><tbody><tr><td>1</td><td>binary</td><td>Данные размером до 8,000 байт (фиксированной длины)</td></tr><tr><td>2</td><td>varbinary</td><td>Данные размером до 8,000 байт (переменной длины)</td></tr><tr><td>3</td><td>image</td><td>Данные размером до 2,147,483,647 байт (переменной длины)</td></tr></tbody></table><p><strong>Смешанные</strong></p><table tabindex="0"><thead><tr><th>N</th><th>Тип данных</th><th>Описание</th></tr></thead><tbody><tr><td>1</td><td>timestamp</td><td>Уникальные числа, обновляющиеся при каждом изменении строки</td></tr><tr><td>2</td><td>uniqueidentifier</td><td>Глобально-уникальный идентификатор (GUID)</td></tr><tr><td>3</td><td>cursor</td><td>Объект курсора</td></tr><tr><td>4</td><td>table</td><td>Промежуточный результат, предназначенный для дальнейшей обработки</td></tr></tbody></table><h2 id="операторы" tabindex="-1">Операторы <a class="header-anchor" href="#операторы" aria-label="Permalink to “Операторы”">​</a></h2><p>Оператор (operators) - это ключевое слово или символ, которые, в основном, используются в инструкциях <code>WHERE</code> для выполнения каких-либо операций. Они используются как для определения условий, так и для объединения нескольких условий в инструкции.</p><p>В дальнейших примерах мы будем исходить из предположения, что переменная <code>a</code> имеет значение <code>10</code>, а <code>b</code> - <code>20</code>.</p><p><strong>Арифметические</strong></p><table tabindex="0"><thead><tr><th>Оператор</th><th>Описание</th><th>Пример</th></tr></thead><tbody><tr><td>+ (сложение)</td><td>Сложение значений</td><td>a + b = 30</td></tr><tr><td>- (вычитание)</td><td>Вычитание правого операнда из левого</td><td>b - a = 10</td></tr><tr><td>* (умножение)</td><td>Умножение значений</td><td>a * b = 200</td></tr><tr><td>/ (деление)</td><td>Деление левого операнда на правый</td><td>b / a = 2</td></tr><tr><td>% (деление с остатком/по модулю)</td><td>Деление левого операнда на правый с остатком (возвращается остаток)</td><td>b % a = 0</td></tr></tbody></table><p><strong>Операторы сравнения</strong></p><table tabindex="0"><thead><tr><th>Оператор</th><th>Описание</th><th>Пример</th></tr></thead><tbody><tr><td><code>=</code></td><td>Определяет равенство значений</td><td><code>a = b -&gt; false</code></td></tr><tr><td><code>!=</code></td><td>Определяет НЕравенство значений</td><td><code>a != b -&gt; true</code></td></tr><tr><td><code>&lt;\\&gt;</code></td><td>Определяет НЕравенство значений</td><td><code>a &lt;\\&gt; b -&gt; true</code></td></tr><tr><td><code>&gt;</code></td><td>Значение левого операнда больше значения правого операнда?</td><td><code>a &gt; b -&gt; false</code></td></tr><tr><td><code>&lt;</code></td><td>Значение левого операнда меньше значения правого операнда?</td><td><code>a &lt; b -&gt; true</code></td></tr><tr><td><code>&gt;=</code></td><td>Значение левого операнда больше или равно значению правого операнда?</td><td><code>a &gt;= b -&gt; false</code></td></tr><tr><td><code>&lt;=</code></td><td>Значение левого операнда меньше или равно значению правого операнда?</td><td><code>a &lt;= b -&gt; true</code></td></tr><tr><td><code>!&lt;</code></td><td>Значение левого операнда НЕ меньше значения правого операнда?</td><td><code>a !&lt; b -&gt; false</code></td></tr><tr><td><code>!&gt;</code></td><td>Значение левого операнда НЕ больше значения правого операнда?</td><td><code>a !&gt; b -&gt; true</code></td></tr></tbody></table><p><strong>Логические операторы</strong></p><table tabindex="0"><thead><tr><th>N</th><th>Оператор</th><th>Описание</th></tr></thead><tbody><tr><td>1</td><td>ALL</td><td>Сравнивает все значения</td></tr><tr><td>2</td><td>AND</td><td>Объединяет условия (все условия должны совпадать)</td></tr><tr><td>3</td><td>ANY</td><td>Сравнивает одно значение с другим, если последнее совпадает с условием</td></tr><tr><td>4</td><td>BETWEEN</td><td>Проверяет вхождение значения в диапазон от минимального до максимального</td></tr><tr><td>5</td><td>EXISTS</td><td>Определяет наличие строки, соответствующей определенному критерию</td></tr><tr><td>6</td><td>IN</td><td>Выполняет поиск значения в списке значений</td></tr><tr><td>7</td><td>LIKE</td><td>Сравнивает значение с похожими с помощью операторов подстановки</td></tr><tr><td>8</td><td>NOT</td><td>Инвертирует (меняет на противоположное) смысл других логических операторов, например, NOT EXISTS, NOT IN и т.д.</td></tr><tr><td>9</td><td>OR</td><td>Комбинирует условия (одно из условий должно совпадать)</td></tr><tr><td>10</td><td>IS NULL</td><td>Определяет, может ли поле иметь значение NULL</td></tr><tr><td>11</td><td>UNIQUE</td><td>Определяет уникальность строки</td></tr></tbody></table><h2 id="выражения" tabindex="-1">Выражения <a class="header-anchor" href="#выражения" aria-label="Permalink to “Выражения”">​</a></h2><p>Выражение (expression) - это комбинация значений, операторов и функций для оценки (вычисления) значения. Выражения похожи на формулы, написанные на языке запросов. Они могут использоваться для извлечения из БД определенного набора данных.</p><p>Базовый синтаксис выражения выглядит так:</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">colN</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [condition</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">expression];</span></span></code></pre></div><p>Существуют различные типы выражений: логические, числовые и выражения для работы с датами.</p><p><strong>Логические</strong></p><p>Логические выражения извлекают данные на основе совпадения с единичным значением.</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">colN</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> выражение для поиска совпадения с единичным значением;</span></span></code></pre></div><p>Предположим, что в таблице <code>users</code> имеются следующие записи:</p><table tabindex="0"><thead><tr><th>userId</th><th>userName</th><th>age</th><th>city</th><th>status</th></tr></thead><tbody><tr><td>1</td><td>Igor</td><td>25</td><td>Moscow</td><td>active</td></tr><tr><td>2</td><td>Vika</td><td>26</td><td>Ekaterinburg</td><td>inactive</td></tr><tr><td>3</td><td>Elena</td><td>27</td><td>Ekaterinburg</td><td>active</td></tr><tr><td>4</td><td>Oleg</td><td>28</td><td>Moscow</td><td>inactive</td></tr></tbody></table><p>Выполняем поиск активных пользователей:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> active;</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>userId</th><th>userName</th><th>age</th><th>city</th><th>status</th></tr></thead><tbody><tr><td>1</td><td>Igor</td><td>25</td><td>Moscow</td><td>active</td></tr><tr><td>3</td><td>Elena</td><td>27</td><td>Ekaterinburg</td><td>active</td></tr></tbody></table><p><strong>Числовые</strong></p><p>Используются для выполнения арифметических операций в запросе.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> numericalExpression </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> operationName</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> condition];</span></span></code></pre></div><p>Простой пример использования числового выражения:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> addition;</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>addition</th></tr></thead><tbody><tr><td>15</td></tr></tbody></table><p>Существует несколько встроенных функций, таких как <code>count()</code>, <code>sum()</code>, <code>avg()</code>, <code>min()</code>, <code>max()</code> и др. для выполнения так называемых агрегирующих вычислений данных таблицы или колонки.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> records </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users;</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>records</th></tr></thead><tbody><tr><td>4</td></tr></tbody></table><ul><li><code>AVG</code> - вычисляет среднее значение</li><li><code>SUM</code> - вычисляет сумму значений</li><li><code>MIN</code> - вычисляет наименьшее значение</li><li><code>MAX</code> - вычисляет наибольшее значение</li><li><code>COUNT</code> - вычисляет количество записей в таблице</li></ul><p>Также существует несколько встроенных функций для работы со строками:</p><ul><li><code>CONCAT</code> - объединение строк</li><li><code>LENGTH</code> - возвращает количество символов в строке</li><li><code>TRIM</code> - удаляет пробелы в начале и конце строки</li><li><code>SUBSTRING</code> - извлекает подстроку из строки</li><li><code>REPLACE</code> - заменяет подстроку в строке</li><li><code>LOWER</code> - переводит символы строки в нижний регистр</li><li><code>UPPER</code> - переводит символы строки в верхний регистр и т.д.</li></ul><p>с числами:</p><ul><li><code>ROUND</code> - округляет число</li><li><code>TRUNCATE</code> - обрезает дробное число до указанного количества знаков после запятой</li><li><code>CEILING</code> - возвращает наименьшее целое число, которое больше или равно текущему значению</li><li><code>FLOOR</code> - возвращает наибольшее целое число, которое меньше или равно текущему значению</li><li><code>POWER</code> - возводит число в указанную степень</li><li><code>SQRT</code> - возвращает квадратный корень числа</li><li><code>RAND</code> - генерирует случайное число с плавающей точкой в диапазоне от 0 до 1</li></ul><p><strong>Выражения для работы с датами</strong></p><p>Эти выражения, как правило, возвращают текущую дату и время.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT_TIMESTAMP;</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>Current_Timestamp</th></tr></thead><tbody><tr><td>2021-06-20 12:45:00</td></tr></tbody></table><p><code>CURRENT_TIMESTAMP</code> - это и выражение, и функция (<code>CURRENT_TIMESTAMP()</code>). Другая функция для получения текущей даты и времени - <code>NOW()</code>.</p><p>Другие функции для получения текущей даты и времени:</p><ul><li><code>CURDATE</code>/<code>CURRENT_DATE</code> - возвращает текущую дату</li><li><code>CURTIME</code>/<code>CURRENT_TIME</code> - возвращает текущее время и т.д.</li></ul><p>Функции для разбора даты и времени:</p><ul><li><code>DAYOFMONTH(date)</code> - возвращает день месяца в виде числа</li><li><code>DAYOFWEEK(date)</code> - возвращает день недели в виде числа</li><li><code>DAYOFYEAR(date)</code> - возвращает номер дня в году</li><li><code>MONTH(date)</code> - возвращает месяц</li><li><code>YEAR(date)</code> - возвращает год</li><li><code>LAST_DAY(date)</code> - возвращает последний день месяца в виде даты</li><li><code>HOUR(time)</code> - возвращает час</li><li><code>MINUTE(time)</code> - возвращает минуты</li><li><code>SECOND(time)</code> - возвращает секунды и др.</li></ul><p>Функции для манипулирования датами:</p><ul><li><code>DATE_ADD(date, interval)</code> - выполняет сложение даты и определенного временного интервала</li><li><code>DATE_SUB(date, interval)</code> - выполняет вычитание из даты определенного временного интервала</li><li><code>DATEDIFF(date1, date2)</code> - возвращает разницу в днях между двумя датами</li><li><code>TO_DAYS(date)</code> - возвращает количество дней с 0-го дня года</li><li><code>TIME_TO_SEC(time)</code> - возвращает количество секунд с полуночи и др.</li></ul><p>Для форматирования даты и времени используются функции <code>DATE_FORMAT(date, format)</code> и <code>TIME_FORMAT(date, format)</code>, соответственно.</p><h2 id="создание-бд" tabindex="-1">Создание БД <a class="header-anchor" href="#создание-бд" aria-label="Permalink to “Создание БД”">​</a></h2><p>Для создания БД используется инструкция <code>CREATE DATABASE</code>.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DATABASE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> dbName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- или</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DATABASE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> IF</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> EXISTS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dbName;</span></span></code></pre></div><p>Условие <code>IF NOT EXISTS</code> позволяет избежать получения ошибки при попытке создания БД, которая уже существует.</p><p>Название БД должно быть уникальным в пределах СУБД.</p><p>Создаем БД <code>testDB</code>:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DATABASE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> testDB</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>Получаем список БД:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SHOW DATABASES;</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>Database</th></tr></thead><tbody><tr><td>information_schema</td></tr><tr><td>postgres</td></tr><tr><td>testDB</td></tr></tbody></table><h2 id="удаление-бд" tabindex="-1">Удаление БД <a class="header-anchor" href="#удаление-бд" aria-label="Permalink to “Удаление БД”">​</a></h2><p>Для удаления БД используется инструкция <code>DROP DATABASE</code>.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DATABASE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dbName;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- или</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DATABASE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> IF</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> EXISTS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dbName;</span></span></code></pre></div><p>Условие <code>IF EXISTS</code> позволяет избежать получения ошибки при попытке удаления несуществующей БД.</p><p>Удаляем <code>testDB</code>:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DATABASE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> testDB;</span></span></code></pre></div><p><em>Обратите внимание</em>: при удалении БД уничтожаются все данные, которые в ней хранятся, так что будьте предельно внимательны при использовании данной команды.</p><p>Проверяем, что БД удалена:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SHOW DATABASES;</span></span></code></pre></div><p>Для получения списка таблиц используется инструкция <code>SHOW TABLES</code>.</p><p>Результат:</p><table tabindex="0"><thead><tr><th>Database</th></tr></thead><tbody><tr><td>information_schema</td></tr><tr><td>postgres</td></tr></tbody></table><h2 id="выбор-бд" tabindex="-1">Выбор БД <a class="header-anchor" href="#выбор-бд" aria-label="Permalink to “Выбор БД”">​</a></h2><p>При наличии нескольких БД, перед выполнением каких-либо операций, необходимо выбрать БД. Для этого используется инструкция <code>USE</code>.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">USE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dbName;</span></span></code></pre></div><p>Предположим, что мы не удаляли <code>testDB</code>. Тогда мы можем выбрать ее так:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">USE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> testDB;</span></span></code></pre></div><h2 id="создание-таблицы" tabindex="-1">Создание таблицы <a class="header-anchor" href="#создание-таблицы" aria-label="Permalink to “Создание таблицы”">​</a></h2><p>Создание таблицы предполагает указание названия таблицы и определение колонок таблицы и их типов данных. Для создания таблицы используется инструкция <code>CREATE TABLE</code>.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> tableName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  col1 datatype,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  col2 datatype,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  colN datatype,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (хотя бы одна колонка)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><p>Для создания таблицы путем копирования другой таблицы используется сочетание <code>CREATE TABLE</code> и <code>SELECT</code>.</p><p>Пример создания таблицы <code>users</code>, где первичным ключом являются идентификаторы пользователей, а поля для имени и возраста пользователя не могут иметь значение <code>NULL</code>:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> users</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  userId </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  userName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">           NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  city </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (id)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><p>Проверяем, что таблица была создана:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users;</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>Field</th><th>Type</th><th>Null</th><th>Key</th><th>Default</th><th>Extra</th></tr></thead><tbody><tr><td>userId</td><td>int(11)</td><td>NO</td><td>PRI</td><td></td><td></td></tr><tr><td>userName</td><td>varchar(20)</td><td>NO</td><td></td><td></td><td></td></tr><tr><td>age</td><td>int(11)</td><td>NO</td><td></td><td></td><td></td></tr><tr><td>city</td><td>varchar(20)</td><td>NO</td><td></td><td></td><td></td></tr><tr><td>status</td><td>varchar(8)</td><td>YES</td><td></td><td>NULL</td><td></td></tr></tbody></table><h2 id="удаление-таблицы" tabindex="-1">Удаление таблицы <a class="header-anchor" href="#удаление-таблицы" aria-label="Permalink to “Удаление таблицы”">​</a></h2><p>Для удаления таблицы используется инструкция <code>DROP TABLE</code>.</p><p><em>Обратите внимание</em>: при удалении таблицы, навсегда удаляются все хранящиеся в ней данные, индексы, триггеры, ограничения и разрешения, так что будьте предельно внимательны при использовании данной команды.</p><p>Удаляем таблицу <code>users</code>:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users;</span></span></code></pre></div><p>Теперь, если мы попытаемся получить описание <code>users</code>, то получим ошибку:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- ERROR 1146 (42S02): Table &#39;testDB.users&#39; doesn&#39;t exist</span></span></code></pre></div><h2 id="добавление-колонок" tabindex="-1">Добавление колонок <a class="header-anchor" href="#добавление-колонок" aria-label="Permalink to “Добавление колонок”">​</a></h2><p>Для добавления в таблицу колонок используется инструкция <code>INSERT INTO</code>.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName (col1, col2, ...colN)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (val1, val2, ...valN);</span></span></code></pre></div><p>Названия колонок можно не указывать, однако, в этом случае значения должны перечисляться в правильном порядке.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (val1, val2, ...valN);</span></span></code></pre></div><p>Во избежание ошибок, рекомендуется всегда перечислять названия колонок.</p><p>Предположим, что мы не удаляли таблицу <code>users</code>. Заполним ее пользователями:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users (userId, userName, age, city, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Igor&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">25</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Moscow&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;active&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users (userId, userName, age, city, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Vika&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">26</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Ekaterinburg&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;inactive&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users (userId, userName, age, city, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Elena&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">27</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Ekaterinburg&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;active&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><p>В таблицу можно добавлять несколько строк за один раз.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users (userId, userName, age, city, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Igor&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">25</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Moscow&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;active&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Vika&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">26</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Ekaterinburg&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;inactive&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Elena&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">27</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Ekaterinburg&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;active&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><p>Также, как было отмечено, при добавлении строки названия полей можно опускать:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Oleg&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">28</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Moscow&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;inactive&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>userId</th><th>userName</th><th>age</th><th>city</th><th>status</th></tr></thead><tbody><tr><td>1</td><td>Igor</td><td>25</td><td>Moscow</td><td>active</td></tr><tr><td>2</td><td>Vika</td><td>26</td><td>Ekaterinburg</td><td>inactive</td></tr><tr><td>3</td><td>Elena</td><td>27</td><td>Ekaterinburg</td><td>active</td></tr><tr><td>4</td><td>Oleg</td><td>28</td><td>Moscow</td><td>inactive</td></tr></tbody></table><p><strong>Заполнение таблицы с помощью другой таблицы</strong></p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName [(col1, col2, ...colN)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> anotherTable</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [WHERE condition];</span></span></code></pre></div><h2 id="выборка-полеи" tabindex="-1">Выборка полей <a class="header-anchor" href="#выборка-полеи" aria-label="Permalink to “Выборка полей”">​</a></h2><p>Для выборки полей из таблицы используется инструкция <code>SELECT</code>. Она возвращает данные в виде результирующей таблицы (результирующего набора, result-set).</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName;</span></span></code></pre></div><p>Для выборки всех полей используется такой синтаксис:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName;</span></span></code></pre></div><p>Произведем выборку полей <code>userId</code>, <code>userName</code> и <code>age</code> из таблицы <code>users</code>:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userId, userName, age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users;</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>userId</th><th>userName</th><th>age</th></tr></thead><tbody><tr><td>1</td><td>Igor</td><td>25</td></tr><tr><td>2</td><td>Vika</td><td>26</td></tr><tr><td>3</td><td>Elena</td><td>27</td></tr><tr><td>4</td><td>Oleg</td><td>28</td></tr></tbody></table><h2 id="предложение-where" tabindex="-1">Предложение <code>WHERE</code> <a class="header-anchor" href="#предложение-where" aria-label="Permalink to “Предложение WHERE”">​</a></h2><p>Предложение <code>WHERE</code> используется для фильтрации возвращаемых данных. Оно используется совместно с <code>SELECT</code>, <code>UPDATE</code>, <code>DELETE</code> и другими инструкциями.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...col2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> condition;</span></span></code></pre></div><p>Условие (condition), которому должны удовлетворять возвращаемые записи, определяется с помощью операторов сравнения или логических операторов типа <code>&gt;</code>, <code>&lt;</code>, <code>=</code>, <code>NOT</code>, <code>LIKE</code> и т.д.</p><p>Сделаем выборку полей <code>userId</code>, <code>userName</code> и <code>age</code> активных пользователей:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userId, userName, age</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;active&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>userId</th><th>userName</th><th>age</th></tr></thead><tbody><tr><td>1</td><td>Igor</td><td>25</td></tr><tr><td>3</td><td>Elena</td><td>27</td></tr></tbody></table><p>Сделаем выборку полей <code>userId</code>, <code>age</code> и <code>city</code> пользователя с именем <code>Vika</code>.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userId, age, city</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Vika&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>userId</th><th>age</th><th>city</th></tr></thead><tbody><tr><td>2</td><td>26</td><td>Ekaterinburg</td></tr></tbody></table><p><em>Обратите внимание</em>: строки в предложении <code>WHERE</code> должны быть обернуты в одинарные кавычки (<code>&#39;&#39;</code>), а числа, напротив, указываются как есть.</p><h2 id="операторы-and-и-or" tabindex="-1">Операторы <code>AND</code> и <code>OR</code> <a class="header-anchor" href="#операторы-and-и-or" aria-label="Permalink to “Операторы AND и OR”">​</a></h2><p>Конъюнктивный оператор <code>AND</code> и дизъюнктивный оператор <code>OR</code> используются для соединения нескольких условий при фильтрации данных.</p><p><strong><code>AND</code></strong></p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> condition1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> condition2 ...</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> conditionN;</span></span></code></pre></div><p>Возвращаемые записи должны удовлетворять всем указанным условиям.</p><p>Сделаем выборку полей <code>userId</code>, <code>userName</code> и <code>age</code> активных пользователей старше 26 лет:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userId, userName, age</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> active </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 26</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>userId</th><th>userName</th><th>AGE</th></tr></thead><tbody><tr><td>3</td><td>Elena</td><td>27</td></tr></tbody></table><p><strong><code>OR</code></strong></p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> condition1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> condition2 ...</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> conditionN;</span></span></code></pre></div><p>Возвращаемые записи должны удовлетворять хотя бы одному условию.</p><p>Сделаем выборку тех же полей неактивных пользователей или пользователей, младше 27 лет:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userId, userName, age</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> inactive </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 27</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>userId</th><th>userName</th><th>age</th></tr></thead><tbody><tr><td>1</td><td>Igor</td><td>25</td></tr><tr><td>2</td><td>Vika</td><td>26</td></tr></tbody></table><h2 id="обновление-полеи" tabindex="-1">Обновление полей <a class="header-anchor" href="#обновление-полеи" aria-label="Permalink to “Обновление полей”">​</a></h2><p>Для обновления полей используется инструкция <code>UPDATE ... SET</code>. Эта инструкция, обычно, используется в сочетании с предложением <code>WHERE</code>.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> val1, col2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> val2, ...colN </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> valN</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[WHERE condition];</span></span></code></pre></div><p>Обновим возраст пользователя с именем <code>Igor</code>:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 30</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> username </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Igor&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>Если в данном случае опустить <code>WHERE</code>, то будет обновлен возраст всех пользователей.</p><h2 id="удаление-записеи" tabindex="-1">Удаление записей <a class="header-anchor" href="#удаление-записеи" aria-label="Permalink to “Удаление записей”">​</a></h2><p>Для удаления записей используется инструкция <code>DELETE</code>. Эта инструкция также, как правило, используется в сочетании с предложением <code>WHERE</code>.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DELETE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[WHERE condition];</span></span></code></pre></div><p>Удалим неактивных пользователей:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DELETE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;inactive&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>Если в данном случае опустить <code>WHERE</code>, то из таблицы <code>users</code> будут удалены все записи.</p><h2 id="предложения-like-и-regex" tabindex="-1">Предложения <code>LIKE</code> и <code>REGEX</code> <a class="header-anchor" href="#предложения-like-и-regex" aria-label="Permalink to “Предложения LIKE и REGEX”">​</a></h2><p><strong><code>LIKE</code></strong></p><p>Предложение <code>LIKE</code> используется для сравнения значений с помощью операторов с подстановочными знаками. Существует два вида таких операторов:</p><ul><li>проценты (<code>%</code>)</li><li>нижнее подчеркивание (<code>_</code>)</li></ul><p><code>%</code> означает 0, 1 или более символов. <code>_</code> означает точно 1 символ.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;xxx%&#39;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- или</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;%xxx%&#39;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- или</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;%xxx&#39;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- или</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;xxx_&#39;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- и т.д.</span></span></code></pre></div><p>Примеры:</p><table tabindex="0"><thead><tr><th>N</th><th>Инструкция</th><th>Результат</th></tr></thead><tbody><tr><td>1</td><td>WHERE col LIKE &#39;foo%&#39;</td><td>Любые значения, начинающиеся с <code>foo</code></td></tr><tr><td>2</td><td>WHERE col LIKE &#39;%foo%&#39;</td><td>Любые значения, содержащие <code>foo</code></td></tr><tr><td>3</td><td>WHERE col LIKE &#39;_oo%&#39;</td><td>Любые значения, содержащие <code>oo</code> на второй и третьей позициях</td></tr><tr><td>4</td><td>WHERE col LIKE &#39;f*%*%&#39;</td><td>Любые значения, начинающиеся с <code>f</code> и состоящие как минимум из 1 символа</td></tr><tr><td>5</td><td>WHERE col LIKE &#39;%oo&#39;</td><td>Любые значения, оканчивающиеся на <code>oo</code></td></tr><tr><td>6</td><td>WHERE col LIKE &#39;_o%o&#39;</td><td>Любые значения, содержащие <code>o</code> на второй позиции и оканчивающиеся на <code>o</code></td></tr><tr><td>7</td><td>WHERE col LIKE &#39;f_o&#39;</td><td>Любые значения, содержащие <code>f</code> и <code>o</code> на первой и третьей позициях, соответственно, и состоящие из трех символов</td></tr></tbody></table><p>Сделаем выборку неактивных пользователей:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;in%&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>userId</th><th>userName</th><th>age</th><th>city</th><th>status</th></tr></thead><tbody><tr><td>2</td><td>Vika</td><td>26</td><td>Ekaterinburg</td><td>inactive</td></tr><tr><td>4</td><td>Oleg</td><td>28</td><td>Moscow</td><td>inactive</td></tr></tbody></table><p>Сделаем выборку пользователей 30 лет и старше:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;3_&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>userId</th><th>userName</th><th>age</th><th>city</th><th>status</th></tr></thead><tbody><tr><td>1</td><td>Igor</td><td>30</td><td>Moscow</td><td>active</td></tr></tbody></table><p><strong>REGEX</strong></p><p>Предложение <code>REGEX</code> позволяет определять регулярное выражение, которому должна соответствовать запись.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> colName REGEXP регулярное выражение;</span></span></code></pre></div><p>В регулярное выражении могут использоваться следующие специальные символы:</p><ul><li><code>^</code> - начало строки</li><li><code>$</code> - конец строки</li><li><code>.</code> - любой символ</li><li><code>[символы]</code> - любой из указанных в скобках символов</li><li><code>[начало-конец]</code> - любой символ из диапазона</li><li><code>|</code> - разделяет шаблоны</li></ul><p>Сделаем выборку пользователей с именами <code>Igor</code> и <code>Vika</code>:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userName REGEXP </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Igor|Vika&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>userId</th><th>userName</th><th>age</th><th>city</th><th>status</th></tr></thead><tbody><tr><td>1</td><td>Igor</td><td>30</td><td>Moscow</td><td>active</td></tr><tr><td>2</td><td>Vika</td><td>26</td><td>Ekaterinburg</td><td>inactive</td></tr></tbody></table><h2 id="предложение-top-limit-rownum" tabindex="-1">Предложение <code>TOP</code>/<code>LIMIT</code>/<code>ROWNUM</code> <a class="header-anchor" href="#предложение-top-limit-rownum" aria-label="Permalink to “Предложение TOP/LIMIT/ROWNUM”">​</a></h2><p>Данные предложения позволяют извлекать указанное количество или процент записей с начала таблицы. Разные СУБД поддерживают разные предложения.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TOP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">|percent col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[WHERE condition];</span></span></code></pre></div><p>Сделаем выборку первых трех пользователей:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TOP</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users;</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>userId</th><th>userName</th><th>age</th><th>city</th><th>status</th></tr></thead><tbody><tr><td>1</td><td>Igor</td><td>30</td><td>Moscow</td><td>active</td></tr><tr><td>2</td><td>Vika</td><td>26</td><td>Ekaterinburg</td><td>inactive</td></tr><tr><td>3</td><td>Elena</td><td>27</td><td>Ekaterinburg</td><td>active</td></tr></tbody></table><p>В <code>mysql</code>:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LIMIT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [offset];</span></span></code></pre></div><p>Параметр <code>offset</code> (смещение) определяет количество пропускаемых записей. Например, так можно извлечь первых двух пользователей, начиная с третьего:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LIMIT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>В <code>oracle</code>:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ROWNUM </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><h2 id="предложения-order-by-и-group-by" tabindex="-1">Предложения <code>ORDER BY</code> и <code>GROUP BY</code> <a class="header-anchor" href="#предложения-order-by-и-group-by" aria-label="Permalink to “Предложения ORDER BY и GROUP BY”">​</a></h2><p><strong><code>ORDER BY</code></strong></p><p>Предложение <code>ORDER BY</code> используется для сортировки данных по возрастанию (<code>ASC</code>) или убыванию (<code>DESC</code>). Многие СУБД по умолчанию выполняют сортировку по возрастанию.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[WHERE condition]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[ORDER BY col1, col2, ...colN] [ASC | DESC];</span></span></code></pre></div><p><em>Обратите внимание</em>: колонки для сортировки должны быть указаны в списке колонок для выборки.</p><p>Сделаем выборку пользователей, отсортировав их по городу и возрасту:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> city, age;</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>userId</th><th>userName</th><th>age</th><th>city</th><th>status</th></tr></thead><tbody><tr><td>2</td><td>Vika</td><td>26</td><td>Ekaterinburg</td><td>inactive</td></tr><tr><td>3</td><td>Elena</td><td>27</td><td>Ekaterinburg</td><td>active</td></tr><tr><td>1</td><td>Igor</td><td>25</td><td>Moscow</td><td>active</td></tr><tr><td>4</td><td>Oleg</td><td>28</td><td>Moscow</td><td>inactive</td></tr></tbody></table><p>Теперь выполним сортировку по убыванию:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> city, age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>Определим собственный порядок сортировки по убыванию:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CASE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> city</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  WHEN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Ekaterinburg&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> THEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  WHEN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Moscow&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> THEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ELSE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> END</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, city </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p><strong><code>GROUP BY</code></strong></p><p>Предложение <code>GROUP BY</code> используется совместно с инструкцией <code>SELECT</code> для группировки записей. Оно указывается после <code>WHERE</code> и перед <code>ORDER BY</code>.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> condition</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GROUP BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN;</span></span></code></pre></div><p>Сгруппируем активных пользователей по городам:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> city, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(city) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> amount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> active</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GROUP BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> city</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> city;</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>city</th><th>amount</th></tr></thead><tbody><tr><td>Ekaterinburg</td><td>2</td></tr><tr><td>Moscow</td><td>2</td></tr></tbody></table><h2 id="ключевое-слово-distinct" tabindex="-1">Ключевое слово <code>DISTINCT</code> <a class="header-anchor" href="#ключевое-слово-distinct" aria-label="Permalink to “Ключевое слово DISTINCT”">​</a></h2><p>Ключевое слово <code>DISTINCT</code> используется совместно с инструкцией <code>SELECT</code> для возврата только уникальных записей (без дубликатов).</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT DISTINCT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[WHERE condition];</span></span></code></pre></div><p>Сделаем выборку городов проживания пользователей:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT DISTINCT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> city</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users;</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>city</th></tr></thead><tbody><tr><td>Ekaterinburg</td></tr><tr><td>Moscow</td></tr></tbody></table><h2 id="соединения" tabindex="-1">Соединения <a class="header-anchor" href="#соединения" aria-label="Permalink to “Соединения”">​</a></h2><p>Соединения (joins) используются для комбинации записей двух и более таблиц.</p><p>Предположим, что кроме <code>users</code>, у нас имеется таблица <code>orders</code> с заказами пользователей следующего содержания:</p><table tabindex="0"><thead><tr><th>orderId</th><th>date</th><th>userId</th><th>amount</th></tr></thead><tbody><tr><td>101</td><td>2021-06-21 00:00:00</td><td>2</td><td>3000</td></tr><tr><td>102</td><td>2021-06-20 00:00:00</td><td>2</td><td>1500</td></tr><tr><td>103</td><td>2021-06-19 00:00:00</td><td>3</td><td>2000</td></tr><tr><td>104</td><td>2021-06-18 00:00:00</td><td>3</td><td>1000</td></tr></tbody></table><p>Сделаем выборку полей <code>userId</code>, <code>userName</code>, <code>age</code> и <code>amount</code> из наших таблиц посредством их соединения:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userId, userName, age, amount</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users, orders</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> users</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">userId</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> orders</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">userId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>userId</th><th>userName</th><th>age</th><th>amount</th></tr></thead><tbody><tr><td>2</td><td>Vika</td><td>26</td><td>3000</td></tr><tr><td>2</td><td>Vika</td><td>26</td><td>1500</td></tr><tr><td>3</td><td>Elena</td><td>27</td><td>2000</td></tr><tr><td>3</td><td>Elena</td><td>27</td><td>1000</td></tr></tbody></table><p>При соединении таблиц могут использоваться такие операторы, как <code>=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>!=</code>, <code>BETWEEN</code>, <code>LIKE</code> и <code>NOT</code>, однако наиболее распространенным является <code>=</code>.</p><p>Существуют разные типы объединений:</p><ul><li><code>INNER JOIN</code> - возвращает записи, имеющиеся в обеих таблицах</li><li><code>LEFT JOIN</code> - возвращает записи из левой таблицы, даже если такие записи отсутствуют в правой таблице</li><li><code>RIGHT JOIN</code> - возвращает записи из правой таблицы, даже если такие записи отсутствуют в левой таблице</li><li><code>FULL JOIN</code> - возвращает все записи объединяемых таблиц</li><li><code>CROSS JOIN</code> - возвращает все возможные комбинации строк обеих таблиц</li><li><code>SELF JOIN</code> - используется для объединения таблицы с самой собой</li></ul><h2 id="предложение-union" tabindex="-1">Предложение <code>UNION</code> <a class="header-anchor" href="#предложение-union" aria-label="Permalink to “Предложение UNION”">​</a></h2><p>Предложение/оператор <code>UNION</code> используется для комбинации результатов двух и более инструкций <code>SELECT</code>. При этом, возвращаются только уникальные записи.</p><p>В случае с <code>UNION</code>, каждая инструкция <code>SELECT</code> должна иметь:</p><ul><li>одинаковый набор колонок для выборки</li><li>одинаковое количество выражений</li><li>одинаковые типы данных колонок и</li><li>одинаковый порядок колонок</li></ul><p>Однако, они могут быть разной длины.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> table1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[WHERE condition]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UNION</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> table2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[WHERE condition];</span></span></code></pre></div><p>Объединим наши таблицы <code>users</code> и <code>orders</code>:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userId, userName, amount, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">date</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  LEFT JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> orders</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ON</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> users</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">useId</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> orders</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">userId</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UNION</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userId, userName, amount, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">date</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  RIGHT JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> orders</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ON</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> users</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">userId</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> orders</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">userId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>userId</th><th>userName</th><th>amount</th><th>date</th></tr></thead><tbody><tr><td>1</td><td>Igor</td><td>NULL</td><td>NULL</td></tr><tr><td>2</td><td>Vika</td><td>3000</td><td>2021-06-21 00:00:00</td></tr><tr><td>2</td><td>Vika</td><td>1500</td><td>2021-06-20 00:00:00</td></tr><tr><td>3</td><td>Elena</td><td>2000</td><td>2021-06-19 00:00:00</td></tr><tr><td>3</td><td>Elena</td><td>1000</td><td>2021-06-18 00:00:00</td></tr><tr><td>4</td><td>Alex</td><td>NULL</td><td>NULL</td></tr></tbody></table><h2 id="предложение-union-all" tabindex="-1">Предложение <code>UNION ALL</code> <a class="header-anchor" href="#предложение-union-all" aria-label="Permalink to “Предложение UNION ALL”">​</a></h2><p>Предложение <code>UNION ALL</code> также используется для объединения результатов двух и более инструкций <code>SELECT</code>. При этом, возвращаются все записи, включая дубликаты.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> table1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[WHERE condition]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UNION ALL</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> table2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[WHERE condition];</span></span></code></pre></div><p>Существует еще два предложения, похожих на <code>UNION</code>:</p><ul><li><code>INTERSECT</code> - используется для комбинации результатов двух и более <code>SELECT</code>, но возвращаются только строки из первого <code>SELECT</code>, совпадающие со строками из второго <code>SELECT</code></li><li><code>EXCEPT|MINUS</code> - возвращаются только строки из первого <code>SELECT</code>, отсутствующие во втором <code>SELECT</code></li></ul><h2 id="синонимы" tabindex="-1">Синонимы <a class="header-anchor" href="#синонимы" aria-label="Permalink to “Синонимы”">​</a></h2><p>Синонимы (aliases) позволяют временно изменять названия таблиц и колонок. &quot;Временно&quot; означает, что новое название используется только в текущем запросе, в БД название остается прежним.</p><p>Синтаксис синонима таблицы:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> aliasName</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[WHERE condition];</span></span></code></pre></div><p>Синтаксис синонима колонки:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> colName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> aliasName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[WHERE condition];</span></span></code></pre></div><p>Пример использования синонимов таблиц:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> U</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">userId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">U</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">userName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">U</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">age</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">O</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">amount</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> U, orders </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> O</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> U</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">userId</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> O</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">userId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>userId</th><th>userName</th><th>age</th><th>amount</th></tr></thead><tbody><tr><td>2</td><td>Vika</td><td>26</td><td>3000</td></tr><tr><td>2</td><td>Vika</td><td>26</td><td>1500</td></tr><tr><td>3</td><td>Elena</td><td>27</td><td>2000</td></tr><tr><td>3</td><td>Elena</td><td>27</td><td>1000</td></tr></tbody></table><p>Пример использования синонимов колонок:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userId </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> user_id, userName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> user_name, age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> user_age</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> active;</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>user_id</th><th>user_name</th><th>user_age</th></tr></thead><tbody><tr><td>1</td><td>Igor</td><td>30</td></tr><tr><td>3</td><td>Elena</td><td>27</td></tr></tbody></table><h2 id="индексы" tabindex="-1">Индексы <a class="header-anchor" href="#индексы" aria-label="Permalink to “Индексы”">​</a></h2><p><strong>Создание индексов</strong></p><p>Индексы - это специальные поисковые таблицы (lookup tables), которые используются движком БД в целях более быстрого извлечения данных. Проще говоря, индекс - это указатель или ссылка на данные в таблице.</p><p>Индексы ускоряют работу инструкции <code>SELECT</code> и предложения <code>WHERE</code>, но замедляют работу инструкций <code>UPDATE</code> и <code>INSERT</code>. Индексы могут создаваться и удаляться, не оказывая никакого влияния на данные.</p><p>Для создания индекса используется инструкция <code>CREATE INDEX</code>, позволяющая определять название индекса, индексируемые колонки и порядок индексации (по возрастанию или по убыванию).</p><p>К индексам можно применять ограничение <code>UNIQUE</code> для того, чтобы обеспечить их уникальность.</p><p>Синтаксис создания индекса:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> INDEX</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> indexName</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName;</span></span></code></pre></div><p>Синтаксис создания индекса для одной колонки:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> INDEX</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> indexName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName (colName);</span></span></code></pre></div><p>Синтакис создания уникальных индексов (такие индексы используются не только для повышения производительности, но и для обеспечения согласованности данных):</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNIQUE INDEX</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> indexName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName (colName);</span></span></code></pre></div><p>Синтаксис создания индексов для нескольких колонок (композиционный индекс):</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> INDEX</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> indexName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName (col1, col2, ...colN);</span></span></code></pre></div><p>Решение о создании индексов для одной или нескольких колонок следует принимать на основе того, какие колонки будут часто использоваться в запросе <code>WHERE</code> в качестве условия для сортировки строк.</p><p>Для ограничений <code>PRIMARY KEY</code> и <code>UNIQUE</code> автоматически создаются неявные индексы.</p><p><strong>Удаление индексов</strong></p><p>Для удаления индексов используется инструкция <code>DROP INDEX</code>:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> INDEX</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> indexName;</span></span></code></pre></div><p>Несмотря на то, что индексы предназначены для повышения производительности БД, существуют ситуации, в которых их использования лучше избегать.</p><p>К таким ситуациям относится следующее:</p><ul><li>индексы не должны использоваться в маленьких таблицах</li><li>в таблицах, которые часто и в большом объеме обновляются или перезаписываются</li><li>в колонках, которые содержат большое количество значений <code>NULL</code></li><li>в колонках, над которыми часто выполняются операции</li></ul><h2 id="обновление-таблицы" tabindex="-1">Обновление таблицы <a class="header-anchor" href="#обновление-таблицы" aria-label="Permalink to “Обновление таблицы”">​</a></h2><p>Команда <code>ALTER TABLE</code> используется для добавления, удаления и модификации колонок существующей таблицы. Также эта команда используется для добавления и удаления ограничений.</p><p>Синтаксис:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- добавление новой колонки</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ADD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> colName datatype;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- удаление колонки</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> COLUMN colName;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- изменение типа данных колонки</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">MODIFY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> COLUMN colName newDatatype;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- добавление ограничения \`NOT NULL\`</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">MODIFY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> colName datatype </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- добавление ограничения \`UNIQUE\`</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ADD</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> CONSTRAINT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> myUniqueConstraint </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UNIQUE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (col1, col2, ...colN);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- добавление ограничения \`CHECK\`</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ADD</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> CONSTRAINT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> myUniqueConstraint </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CHECK</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (condition);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- добавление первичного ключа</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ADD</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> CONSTRAINT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> myPrimaryKey </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (col1, col2, ...colN);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- удаление ограничения</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> CONSTRAINT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> myUniqueContsraint;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- mysql</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> INDEX</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> myUniqueContsraint;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- удаление первичного ключа</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> CONSTRAINT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> myPrimaryKey;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- mysql</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>Добавляем в таблицу <code>users</code> новую колонку - пол пользователя:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ADD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sex </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">char</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><p>Удаляем эту колонку:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sex;</span></span></code></pre></div><h2 id="очистка-таблицы" tabindex="-1">Очистка таблицы <a class="header-anchor" href="#очистка-таблицы" aria-label="Permalink to “Очистка таблицы”">​</a></h2><p>Команда <code>TRUNCATE TABLE</code> используется для очистки таблицы. Ее отличие от <code>DROP TABLE</code> состоит в том, что сохраняется структура таблицы (<code>DROP TABLE</code> полностью удаляет таблицу и все ее данные).</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TRUNCATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName;</span></span></code></pre></div><p>Очищаем таблицу <code>users</code>:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TRUNCATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users;</span></span></code></pre></div><p>Проверяем, что <code>users</code> пустая:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- Empty set (0.00 sec)</span></span></code></pre></div><h2 id="представления" tabindex="-1">Представления <a class="header-anchor" href="#представления" aria-label="Permalink to “Представления”">​</a></h2><p>Представление (view) - это не что иное, как инструкция, записанная в БД под определенным названием. Другими словами, представление - это композиция таблицы в форме предварительно определенного запроса.</p><p>Представления могут содержать все или только некоторые строки таблицы. Представление может быть создано на основе одной или нескольких таблиц (это зависит от запроса для создания представления).</p><p>Представления - это виртутальные таблицы, позволяющие делать следующее:</p><ul><li>структурировать данные способом, который пользователи находят наиболее естественным или интуитивно понятным</li><li>ограничивать доступ к данным таким образом, что пользователь может просматривать и (иногда) модифицировать только то, что ему нужно и ничего более</li><li>объединять данные из нескольких таблиц для формирования отчетов</li></ul><p><strong>Создание представления</strong></p><p>Для создания представления используется инструкция <code>CREATE VIEW</code>. Как было отмечено, представления могут создаваться на основе одной или нескольких таблиц, и даже на основе другого представления.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> VIEW</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> viewName</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AS</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[WHERE condition];</span></span></code></pre></div><p>Создаем представление для имен и возраста пользователей:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> VIEW</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> usersView</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AS</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userName, age</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users;</span></span></code></pre></div><p>Получаем данные с помощью представления:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> usersView;</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>userName</th><th>age</th></tr></thead><tbody><tr><td>Igor</td><td>30</td></tr><tr><td>Vika</td><td>26</td></tr><tr><td>Elena</td><td>27</td></tr><tr><td>Oleg</td><td>28</td></tr></tbody></table><p><strong><code>WITH CHECK OPTION</code></strong></p><p><code>WITH CHECK OPTION</code> - это настройка инструкции <code>CREATE VIEW</code>. Она позволяет обеспечить соответствие всех <code>UPDATE</code> и <code>INSERT</code> условию, определенном в представлении.</p><p>Если условие не удовлетворяется, выбрасывается исключение.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> VIEW</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> usersView</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AS</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userName, age</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">IS NOT NULL</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WITH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> CHECK</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> OPTION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p><strong>Обновление представления</strong></p><p>Представление может быть обновлено при соблюдении следующих условий:</p><ul><li><code>SELECT</code> не содержит ключевого слова <code>DISTINCT</code></li><li><code>SELECT</code> не содержит агрегирующих функций</li><li><code>SELECT</code> не содержит функций установки значений</li><li><code>SELECT</code> не содержит операций установки значений</li><li><code>SELECT</code> не содержит предложения <code>ORDER BY</code></li><li><code>FROM</code> не содержит больше одной таблицы</li><li><code>WHERE</code> не содержит подзапросы</li><li>запрос не содержит <code>GROUP BY</code> или <code>HAVING</code></li><li>вычисляемые колонки не обновляются</li><li>все ненулевые колонки из базовой таблицы включены в представление в том же порядке, в каком они указаны в запросе <code>INSERT</code></li></ul><p>Пример обновления возраста пользователя с именем <code>Igor</code> в представлении:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> usersView</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 31</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Igor&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p><em>Обратите внимание</em>: обновление строки в представлении приводит к ее обновлению в базовой таблице.</p><p>В представление могут добавляться новые строки с помощью команды <code>INSERT</code>. При выполнении этой команды должны соблюдаться те же правила, что и при выполнении команды <code>UPDATE</code>.</p><p>С помощью команды <code>DELETE</code> можно удалять строки из представления.</p><p>Удаляем из представления пользователя, возраст которого составляет 26 лет:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DELETE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> usersView</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 26</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p><em>Обратите внимание</em>: удаление строки в представлении приводит к ее удалению в базовой таблице.</p><p><strong>Удаление представления</strong></p><p>Для удаления представления используется инструкция <code>DROP VIEW</code>:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> VIEW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> viewName;</span></span></code></pre></div><p>Удаляем представление <code>usersView</code>:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> VIEW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> usersView;</span></span></code></pre></div><h2 id="having" tabindex="-1">HAVING <a class="header-anchor" href="#having" aria-label="Permalink to “HAVING”">​</a></h2><p>Предложение <code>HAVING</code> используется для фильтрации результатов группировки. <code>WHERE</code> используется для применения условий к колонкам, а <code>HAVING</code> - к группам, созданным с помощью <code>GROUP BY</code>.</p><p><code>HAVING</code> должно указываться после <code>GROUP BY</code>, но перед <code>ORDER BY</code> (при наличии).</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> table1, table2, ...tableN</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[WHERE condition]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GROUP BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">HAVING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> condition</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN;</span></span></code></pre></div><h2 id="транзакции" tabindex="-1">Транзакции <a class="header-anchor" href="#транзакции" aria-label="Permalink to “Транзакции”">​</a></h2><p>Транзакция - это единица работы или операции, выполняемой над БД. Это последовательность операций, выполняемых в логическом порядке. Эти операции могут запускаться как пользователем, так и какой-либо программой, функционирующей в БД.</p><p>Транзакция - это применение одного или более изменения к БД. Например, при создании/обновлении/удалении записи мы выполняем транзакцию. Важно контролировать выполнение таких операций в целях обеспечения согласованности данных и обработки возможных ошибок.</p><p>На практике, запросы, как правило, не отправляются в БД по одному, они группируются и выполняются как часть транзакции.</p><p><strong>Свойства транзакции</strong></p><p>Транзакции имеют 4 стандартных свойства (ACID):</p><ul><li>атомарность (atomicity) - все операции транзакции должны быть успешно завершены. В противном случае, транзакция прерывается, а все изменения отменяются (происходит откат к предыдущему состоянию)</li><li>согласованность (consistency) - состояние должно изменться в полном соответствии с операциями транзакции</li><li>изоляция или автономность (isolation) - транзакции не зависят друг от друга и не оказывают друг на друга никакого влияния</li><li>долговечность (durability) - результат звершенной транзакции должен сохраняться при поломке системы</li></ul><p><strong>Управление транзакцией</strong></p><p>Для управления транзакцией используются следующие команды:</p><ul><li><code>BEGIN|START TRANSACTION</code> - запуск транзакции</li><li><code>COMMIT</code> - сохранение изменений</li><li><code>ROLLBACK</code> - отмена изменений</li><li><code>SAVEPOINT</code> - контрольная точка для отмены изменений</li><li><code>SET TRANSACTION</code> - установка характеристик текущей транзакции</li></ul><p>Команды для управления транзакцией могут использоваться только совместно с такими запросами как <code>INSERT</code>, <code>UPDATE</code> и <code>DELETE</code>. Они не могут использоваться во время создания и удаления таблиц, поскольку эти операции автоматически отправляются в БД.</p><p>Удаляем пользователя, возраст которого составляет 26 лет, и отправляем изменения в БД:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BEGIN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TRANSACTION</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DELETE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 26</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COMMIT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>Удаляем пользователя с именем <code>Oleg</code> и отменяем эту операцию:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BEGIN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  DELETE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> username </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Oleg&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROLLBACK</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>Контрольные точки создаются с помощью такого синтаксиса:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SAVEPOINT savepointName;</span></span></code></pre></div><p>Возврат к контрольной точке выполняется так:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROLLBACK</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> savepointName;</span></span></code></pre></div><p>Выполняем три запроса на удаление данных из <code>users</code>, создавая контрольные точки перед каждый удалением:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">START TRANSACTION</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SAVEPOINT sp1;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DELETE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 26</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SAVEPOINT sp2;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DELETE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Oleg&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SAVEPOINT sp3;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DELETE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;inactive&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>Отменяем два последних удаления, возвращаясь к контрльной точке <code>sp2</code>, созданной после первого удаления:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROLLBACK</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sp2;</span></span></code></pre></div><p>Делаем выборку пользователей:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users;</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>userId</th><th>userName</th><th>age</th><th>city</th><th>status</th></tr></thead><tbody><tr><td>1</td><td>Igor</td><td>31</td><td>Moscow</td><td>active</td></tr><tr><td>3</td><td>Elena</td><td>27</td><td>Ekaterinburg</td><td>active</td></tr><tr><td>4</td><td>Oleg</td><td>28</td><td>Moscow</td><td>inactive</td></tr></tbody></table><p>Как видим, из таблицы был удален только пользователь с возрастом 26 лет.</p><p>Для удаление контрольной точки используется команда <code>RELEASE SAVEPOINT</code>. Естественно, после удаления контрольной точки, к ней нельзя будет вернуться с помощью <code>ROLLBACK TO</code>.</p><p>Команда <code>SET TRANSACTION</code> используется для инициализации транзакции, т.е. начала ее выполнения. При этом, можно определять некоторые характеристики транзакции. Например, так можно определить уровень доступа транзакции (доступна только для чтения или для записи тоже):</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TRANSACTION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [READ WRITE | READ ONLY];</span></span></code></pre></div><h2 id="временные-таблицы" tabindex="-1">Временные таблицы <a class="header-anchor" href="#временные-таблицы" aria-label="Permalink to “Временные таблицы”">​</a></h2><p>Некоторые СУБД поддерживают так называемые временные таблицы (temporary tables). Такие таблицы позволяют хранить и обрабатывать промежуточные результаты с помощью таких же запросов, как и при работе с обычными таблицами.</p><p>Временные таблицы могут быть очень полезными при необходимости хранения временных данных. Одной из главных особенностей таких таблиц является то, что они удаляются по завершении текущей сессии. При запуске скрипта временная таблица удаляется после завершения выполнения этого скрипта. При доступе к БД с помощью клиентской программы, такая таблица будет удалена после закрытия этой программы.</p><p>Временная таблица создается с помощью инструкции <code>CREATE TEMPORARY TABLE</code>, в остальном синтаксис создания таких таблиц идентичен синтаксису создания обычных таблиц.</p><p>Временная таблица удаляется точно также, как и обычная таблица, с помощью инструкции <code>DROP TABLE</code>.</p><h2 id="клонирование-таблицы" tabindex="-1">Клонирование таблицы <a class="header-anchor" href="#клонирование-таблицы" aria-label="Permalink to “Клонирование таблицы”">​</a></h2><p>Может возникнуть ситуация, когда потребуется получить точную копию существующей таблицы, а <code>CREATE TABLE</code> или <code>SELECT</code> окажется недостаточно в силу того, что мы хотим получить не только идентичную структуру, но также индексы, значения по умолчанию и т.д. копируемой таблицы.</p><p>В <code>mysql</code>, например, это можно сделать так:</p><ul><li>вызываем команду <code>SHOW CREATE TABLE</code> для получения инструкции, выполненной при создании таблицы, включая индексы и прочее</li><li>меняем название таблицы и выполняем запрос. Получаем точную копию таблицы</li><li>опционально: если требуется содержимое копируемой таблицы, можно также использовать инструкции <code>INSERT INTO</code> или <code>SELECT</code></li></ul><h2 id="подзапросы" tabindex="-1">Подзапросы <a class="header-anchor" href="#подзапросы" aria-label="Permalink to “Подзапросы”">​</a></h2><p>Подзапрос - это внутренний (вложенный) запрос другого запроса, встроенный (вставленный) с помощью <code>WHERE</code> или других инструкций.</p><p>Подзапрос используется для получения данных, которые будут использованы основным запросом в качестве условия для фильтрации возвращаемых записей.</p><p>Подзапросы могут использоваться в инструкциях <code>SELECT</code>, <code>INSERT</code>, <code>UPDATE</code> и <code>DELETE</code>, а также с операторами <code>=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>IN</code>, <code>BETWEEN</code> и т.д.</p><p>Правила использования подзапросов:</p><ul><li>они должны быть обернуты в круглые скобки</li><li>подзапрос должен содержать только одну колонку для выборки, если основной запрос не содержит несколько таких колонок, которые сравниваются в подзапросе</li><li>в подзапросе нельзя использовать команду <code>ORDER BY</code>, это можно сделать в основном запросе. В подзапросе для замены <code>ORDER BY</code> можно использовать <code>GROUP BY</code></li><li>подзапросы, возвращающие несколько значений, могут использоваться только с операторами, которые работают с наборами значений, такими как <code>IN</code></li><li>список <code>SELECT</code> не может содержать ссылки на значения, которые оцениваются (вычисляются) как <code>BLOB</code>, <code>ARRAY</code>, <code>CLOB</code> или <code>NCLOB</code></li><li>подзапрос не может быть сразу передан в функцию для установки значений</li><li>команду <code>BETWEEN</code> нельзя использовать совместно с подзапросом. Тем не менее, в самомподзапросе указанную команду использовать можно</li></ul><p>Подзапросы, обычно, используются в инструкции <code>SELECT</code>.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> table1, table2, ...tableN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> colName operator</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> table1, table2, tableN</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [WHERE condition]);</span></span></code></pre></div><p>Пример:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userId </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">IN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userId </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;active&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><p>Результат:</p><table tabindex="0"><thead><tr><th>userId</th><th>userName</th><th>age</th><th>city</th><th>status</th></tr></thead><tbody><tr><td>1</td><td>Igor</td><td>30</td><td>Moscow</td><td>active</td></tr><tr><td>3</td><td>Elena</td><td>27</td><td>Ekaterinburg</td><td>active</td></tr></tbody></table><p>Подзапросы могут использоваться в инструкции <code>INSERT</code>. Эта инструкция добавляет в таблицу данные, возвращаемые подзапросом. При этом, данные, возвращаемые подзапросом, могут быть модифицированы любыми способами.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col1, col2, ...colN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> table1, table2, ...tableN</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[WHERE operator [value]];</span></span></code></pre></div><p>Подзапросы могут использоваться в инструкции <code>UPDATE</code>. При этом, данные из подзапроса могут использоваться для обновления любого количества колонок.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newVal</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[WHERE operator [value]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> colName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [WHERE condition]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span></code></pre></div><p>Данные, возвращаемые подзапросом, могут использоваться и для удаления записей.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DELETE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[WHERE operator [value]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> colName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [WHERE condition]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span></code></pre></div><h2 id="последовательности" tabindex="-1">Последовательности <a class="header-anchor" href="#последовательности" aria-label="Permalink to “Последовательности”">​</a></h2><p>Последовательность - это набор целых чисел (1, 2, 3 и т.д.), генерируемых автоматически. Последовательности часто используются в БД, поскольку многие приложения нуждаются в уникальных значениях, используемых для идентификации строк.</p><p>Приведенные ниже примеры рассчитаны на <code>mysql</code>.</p><p>Простейшим способом определения последовательности является использование <code>AUTO_INCREMENT</code> при создании таблицы:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> tableName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UNSIGNED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> AUTO_INCREMENT,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (id),</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  -- другие строки</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><p>Для того, чтобы заново пронумеровать строки с помощью автоматически генерируемых значений (например, при удалении большого количества строк), можно удалить колонку, содержащую такие значения и создать ее заново. <em>Обратите внимание</em>: такая таблица не должна быть частью объединения.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tableName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ADD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UNSIGNED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> AUTO_INCREMENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FIRST</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ADD</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (id);</span></span></code></pre></div><p>По умолчанию значения, генерируемые с помощью <code>AUTO_INCREMENT</code>, начинаются с 1. Для того, чтобы установить другое начальное значение достаточно указать, например, <code>AUTO_INCREMENT = 100</code> - в этом случае нумерация строк начнется со 100.</p>`,478)]))}const o=i(l,[["render",e]]);export{c as __pageData,o as default};
